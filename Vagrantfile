# Common Variables
alpine_box = "generic/alpine38"
kali_box = "kalilinux/rolling"

# Juice Shop
juice_shop_ip = "192.168.56.10"
juice_shop_memory = "1024"
juice_shop_cpus = 1

# Damn Vulnerable Web Application (DVWA)
dvwa_ip = "192.168.56.20"
dvwa_memory = "1024"
dvwa_cpus = 1

# VulnLab
vulnlab_ip = "192.168.56.30"
vulnlab_memory = "1024"
vulnlab_cpus = 1

# Kali Linux
kali_ip = "192.168.56.100"
kali_memory = "4096"
kali_cpus = 2

Vagrant.configure("2") do |config|
  # Juice Shop
  config.vm.define "jshop" do |jshop|
    jshop.vm.box = alpine_box
    jshop.vm.hostname = "jshop"
    jshop.vm.provider "virtualbox" do |vb|
      vb.memory = juice_shop_memory
      vb.gui = false
      vb.cpus = juice_shop_cpus
    end
    jshop.vm.network "private_network", ip: juice_shop_ip
    jshop.vm.provision "shell", inline: <<-SHELL
    apk update
    apk add --no-cache curl
    apk add --no-cache docker
    apk add --no-cache python3 py3-pip
    pip3 install --upgrade pip
    service docker start
    sleep 5
    docker pull bkimminich/juice-shop
    sleep 5
    docker run -d -p 3000:3000 bkimminich/juice-shop
    echo "JUICE SHOP IS READY TO BE HACKED!"
    SHELL
  end

  # Damn Vulnerable Web Application (DVWA)
  config.vm.define "dvwa" do |dvwa|
    dvwa.vm.box = alpine_box
    dvwa.vm.hostname = "dvwa"
    dvwa.vm.provider "virtualbox" do |vb|
      vb.memory = dvwa_memory
      vb.gui = false
      vb.cpus = dvwa_cpus
    end
    dvwa.vm.network "private_network", ip: dvwa_ip
    dvwa.vm.provision "shell", inline: <<-SHELL
    apk update
    apk add --no-cache curl
    apk add --no-cache docker
    apk add --no-cache python3 py3-pip
    pip3 install --upgrade pip
    service docker start
    sleep 5
    docker pull citizenstig/dvwa
    sleep 5
    docker run -d -p 80:80 citizenstig/dvwa
    echo "DVWA IS READY TO BE HACKED!"
    SHELL
  end

  # VulnLab
  config.vm.define "vulnlab" do |vulnlab|
    vulnlab.vm.box = alpine_box
    vulnlab.vm.hostname = "vulnlab"
    vulnlab.vm.provider "virtualbox" do |vb|
      vb.memory = vulnlab_memory
      vb.gui = false
      vb.cpus = vulnlab_cpus
    end
    vulnlab.vm.network "private_network", ip: vulnlab_ip
    vulnlab.vm.provision "shell", inline: <<-SHELL
    apk update
    apk add --no-cache curl
    apk add --no-cache docker
    apk add --no-cache python3 py3-pip
    pip3 install --upgrade pip
    service docker start
    sleep 5
    docker pull yavuzlar/vulnlab
    sleep 5
    docker run -d -p 1337:80 yavuzlar/vulnlab
    echo "VULNLAB IS READY TO BE HACKED!"
    SHELL
  end

  # Kali Linux
  config.vm.define "kali" do |kali|
    kali.vm.box = kali_box
    kali.vm.hostname = "kali"
    kali.vm.provider "virtualbox" do |vb|
      vb.memory = kali_memory
      vb.gui = true
      vb.cpus = kali_cpus
    end
    kali.vm.network "private_network", ip: kali_ip
    kali.vm.provision "shell", inline: <<-SHELL
      echo "KALI LINUX IS FULLY UPDATED & READY TO PENTEST!"
    SHELL
  end
end
